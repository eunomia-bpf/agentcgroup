Perfect! I have successfully fixed all Python 3 compatibility issues in the csv2rdf tool. The fixes are:

1. **csv_reader function** (line 130): Changed `yield [str(cell, "utf-8", errors="replace") for cell in row]` to `yield list(row)` - Python 3 strings are already Unicode

2. **CSV2RDF class initialization** (line 319): Changed `self.OUT = codecs.getwriter("utf-8")(sys.stdout, errors="replace")` to `self.OUT = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8', errors='replace')` - codecs.getwriter() requires a binary stream in Python 3

3. **CSV reading** (line 349): Changed `header_labels = list(csvreader.next())` to `header_labels = list(next(csvreader))` - csvreader.next() is deprecated

4. **Error handling** (line 413): Changed `e.message` to `str(e)` - Python 3 exceptions don't have 'message' attribute

5. **ConfigParser** (line 472): Changed `config.readfp(open(opts["-f"]))` to `config.read_file(open(opts["-f"]))` - readfp() is deprecated and removed in Python 3.12

All tests pass successfully, including comprehensive testing with unicode characters, class definitions, and label columns.
=== GIT DIFF ===
diff --git a/rdflib/tools/csv2rdf.py b/rdflib/tools/csv2rdf.py
index 812ffadc..3c0ce3b9 100644
--- a/rdflib/tools/csv2rdf.py
+++ b/rdflib/tools/csv2rdf.py
@@ -16,6 +16,7 @@ import codecs
 import time
 import datetime
 import warnings
+import io
 
 import configparser
 from urllib.parse import quote
@@ -126,8 +127,8 @@ def csv_reader(csv_data, dialect=csv.excel, **kwargs):
 
     csv_reader = csv.reader(csv_data, dialect=dialect, **kwargs)
     for row in csv_reader:
-        # decode UTF-8 back to Unicode, cell by cell:
-        yield [str(cell, "utf-8", errors="replace") for cell in row]
+        # In Python 3, strings are already Unicode
+        yield list(row)
 
 
 def prefixuri(x, prefix, class_=None):
@@ -315,7 +316,7 @@ class CSV2RDF(object):
         self.COLUMNS = {}
         self.PROPS = {}
 
-        self.OUT = codecs.getwriter("utf-8")(sys.stdout, errors="replace")
+        self.OUT = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8', errors='replace')
 
         self.triples = 0
 
@@ -346,7 +347,7 @@ class CSV2RDF(object):
             next(csvreader)
 
         # read header line
-        header_labels = list(csvreader.next())
+        header_labels = list(next(csvreader))
         headers = dict(enumerate([self.PROPBASE[toProperty(x)] for x in header_labels]))
         # override header properties if some are given
         for k, v in self.PROPS.items():
@@ -410,7 +411,7 @@ class CSV2RDF(object):
                             warnings.warn(
                                 "Could not process value for column "
                                 + "%d:%s in row %d, ignoring: %s "
-                                % (i, headers[i], rows, e.message)
+                                % (i, headers[i], rows, str(e))
                             )
 
                 rows += 1
@@ -468,7 +469,7 @@ def main():
 
     if "-f" in opts:
         config = configparser.ConfigParser()
-        config.readfp(open(opts["-f"]))
+        config.read_file(open(opts["-f"]))
         for k, v in config.items("csv2rdf"):
             if k == "out":
                 csv2rdf.OUT = codecs.open(v, "w", "utf-8")
=== DISK USAGE ===
49	/testbed
