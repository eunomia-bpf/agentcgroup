API Error: 400 {"error":{"code":400,"message":"request (129100 tokens) exceeds the available context size (128000 tokens), try increasing it","type":"exceed_context_size_error","n_prompt_tokens":129100,"n_ctx":128000}}
=== GIT DIFF ===
diff --git a/sqlglot/parser.py b/sqlglot/parser.py
index 5fa7d1ef..4191f36e 100644
--- a/sqlglot/parser.py
+++ b/sqlglot/parser.py
@@ -4424,6 +4424,23 @@ class Parser(metaclass=_Parser):
     def _parse_disjunction(self) -> t.Optional[exp.Expression]:
         return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
 
+    def _parse_tokens(
+        self, func: t.Callable[["Parser"], t.Optional[exp.Expression]], tokens: t.Set[TokenType]
+    ) -> t.Optional[exp.Expression]:
+        if self._curr and self._curr.token_type in tokens:
+            this = func(self)
+            while self._match_set(tokens):
+                expression = func(self)
+                this = self.expression(
+                    self.TOKENS[self._prev.token_type],
+                    this=this,
+                    comments=self._prev_comments,
+                    expression=expression,
+                )
+            return this
+
+        return None
+
     def _parse_conjunction(self) -> t.Optional[exp.Expression]:
         return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
 
@@ -5028,6 +5045,10 @@ class Parser(metaclass=_Parser):
         if isinstance(this, exp.Identifier):
             # We bubble up comments from the Identifier to the Column
             this = self.expression(exp.Column, comments=this.pop_comments(), this=this)
+        elif isinstance(this, exp.Window):
+            # Don't wrap Window expressions in Column - they're already handled at the function call level
+            # The Window should not have db/table/catalog qualifiers
+            pass
 
         return this
 
@@ -5120,13 +5141,17 @@ class Parser(metaclass=_Parser):
                         if n.table
                         else n.this
                     )
-                    if isinstance(n, exp.Column)
+                    if isinstance(n, exp.Column) and not isinstance(n.this, exp.Window)
                     else n,
                 )
 
             if op:
                 this = op(self, this, field)
-            elif isinstance(this, exp.Column) and not this.args.get("catalog"):
+            elif (
+                isinstance(this, exp.Column)
+                and not this.args.get("catalog")
+                and not isinstance(this.this, exp.Window)
+            ):
                 this = self.expression(
                     exp.Column,
                     comments=this.comments,
@@ -5418,6 +5443,10 @@ class Parser(metaclass=_Parser):
         else:
             this = self._parse_select_or_expression(alias=alias)
 
+        # Don't wrap Window expressions in Column - they're already handled at the function call level
+        if isinstance(this, exp.Window):
+            return this
+
         return self._parse_limit(
             self._parse_order(self._parse_having_max(self._parse_respect_or_ignore_nulls(this)))
         )
=== DISK USAGE ===
583	/testbed
