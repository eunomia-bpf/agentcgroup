
=== GIT DIFF ===
diff --git a/dask/array/einsumfuncs.py b/dask/array/einsumfuncs.py
index 4d236db49..03b962a3f 100644
--- a/dask/array/einsumfuncs.py
+++ b/dask/array/einsumfuncs.py
@@ -241,11 +241,14 @@ def einsum(*operands, dtype=None, optimize=False, split_every=None, **kwargs):
             max_chunk_size_input = max(
                 reduce(mul, map(max, op.chunks)), max_chunk_size_input
             )
-            max_chunk_sizes.extend(
-                max(op.chunks[i])
-                for i, inp in enumerate(input)
-                if inp not in contract_inds
-            )
+            # Track max chunk size per index, accounting for shared axes between inputs
+            max_chunk_size_by_index = {}
+            for i, inp in enumerate(input):
+                if inp not in contract_inds:
+                    max_chunk_size_by_index[inp] = max(
+                        max_chunk_size_by_index.get(inp, 0), op.chunks[i]
+                    )
+            max_chunk_sizes.extend(max_chunk_size_by_index.values())
 
         max_chunk_size_output = reduce(mul, max_chunk_sizes)
         factor = max_chunk_size_output / (
=== DISK USAGE ===
147	/testbed
