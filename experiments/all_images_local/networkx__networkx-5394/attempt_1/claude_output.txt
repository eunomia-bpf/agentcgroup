
=== GIT DIFF ===
diff --git a/networkx/algorithms/matching.py b/networkx/algorithms/matching.py
index 2a57e9a13..3e36a3b29 100644
--- a/networkx/algorithms/matching.py
+++ b/networkx/algorithms/matching.py
@@ -262,9 +262,21 @@ def min_weight_matching(G, maxcardinality=False, weight="weight"):
     if len(G.edges) == 0:
         return max_weight_matching(G, maxcardinality, weight)
     G_edges = G.edges(data=weight, default=1)
-    min_weight = min(w for _, _, w in G_edges)
+    # Filter out self-loops
+    G_edges = [(u, v, w) for u, v, w in G_edges if u != v]
+    if len(G_edges) == 0:
+        return set()
+    # Find min and max weights
+    weights = [w for _, _, w in G_edges]
+    min_weight = min(weights)
+    max_weight = max(weights)
     InvG = nx.Graph()
-    edges = ((u, v, 1 / (1 + w - min_weight)) for u, v, w in G_edges)
+    # Transform to positive weights: use -1/w + C where C is large enough
+    # If w1 < w2, then -1/w1 < -1/w2, so T1 < T2
+    # This means smaller original weights get smaller transformed weights
+    # so max_weight_matching will prefer them (minimizing sum(w))
+    # Use -1/w + 20 to ensure positivity for all weights
+    edges = ((u, v, -1/w + 20) for u, v, w in G_edges)
     InvG.add_weighted_edges_from(edges, weight=weight)
     return max_weight_matching(InvG, maxcardinality, weight)
 
=== DISK USAGE ===
108	/testbed
